package templates

templ Layout(title string) {
	<!DOCTYPE html>
	<html lang="en" data-theme="whalio">
	<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<title>{ title } - Whalio</title>
		
		<!-- Favicon -->
		<link rel="icon" type="image/x-icon" href="/static/favicon.ico"/>
		
		<!-- Stylesheets -->
		<link href="/static/css/output.css" rel="stylesheet"/>
		
			<!-- Scripts -->
			<script src="https://unpkg.com/htmx.org@2.0.3"></script>
			<script src="https://unpkg.com/alpinejs@3.14.1/dist/cdn.min.js" defer></script>
			<script src="/static/js/app.js?v=2" defer></script>
		
		<!-- Meta tags -->
		<meta name="description" content="Modern web application built with Go, templ, HTMX, TailwindCSS and DaisyUI"/>
		<meta name="author" content="Whalio"/>
		<meta name="theme-color" content="#3b82f6"/>
		
		<!-- PWA Meta -->
		<meta name="mobile-web-app-capable" content="yes"/>
		<meta name="apple-mobile-web-app-capable" content="yes"/>
		<meta name="apple-mobile-web-app-status-bar-style" content="default"/>
	</head>
	<body class="min-h-screen bg-base-100 transition-colors duration-300" x-data="{ sidebarOpen: false }">
		<!-- Loading overlay -->
		<div 
			x-data="{ loading: false }"
			x-show="loading" 
			x-transition:enter="transition ease-out duration-300"
			x-transition:enter-start="opacity-0"
			x-transition:enter-end="opacity-100"
			x-transition:leave="transition ease-in duration-200"
			x-transition:leave-start="opacity-100"
			x-transition:leave-end="opacity-0"
			class="fixed inset-0 bg-base-100 bg-opacity-80 backdrop-blur-sm flex items-center justify-center z-50"
			x-init="
				document.addEventListener('htmx:beforeRequest', () => { loading = true });
				document.addEventListener('htmx:afterRequest', () => { setTimeout(() => loading = false, 300) });
			"
		>
			<div class="flex flex-col items-center space-y-4">
				<div class="loading loading-spinner loading-lg text-primary"></div>
				<p class="text-base-content font-medium">Loading...</p>
			</div>
		</div>
		
		@EnhancedNavbar(title)
		
		<!-- Breadcrumbs -->
		if title != "Home" {
			<div class="container mx-auto px-4 py-2">
				<div class="breadcrumbs text-sm">
					<ul>
						<li><a href="/" class="link link-hover">🏠 Home</a></li>
						<li class="text-base-content/70">{ title }</li>
					</ul>
				</div>
			</div>
		}
		
		<!-- Page Header -->
		if title != "Home" {
			<div class="bg-gradient-to-r from-primary/10 to-secondary/10 py-8">
				<div class="container mx-auto px-4">
					<h1 class="text-4xl font-bold text-primary">{ title }</h1>
					<p class="text-base-content/70 mt-2">Welcome to the { title } section</p>
				</div>
			</div>
		}
		
		<main class="container mx-auto px-4 py-6 animate-fade-in">
			{ children... }
		</main>
		
		@PlayerBar()
		@EnhancedFooter()
		@GlobalModals()
		
		<!-- Back to top button -->
		<button 
			x-data="{ show: false }"
			x-show="show"
			x-transition
			x-init="
				window.addEventListener('scroll', () => {
					show = window.scrollY > 400
				})
			"
			@click="window.scrollTo({ top: 0, behavior: 'smooth' })"
			class="fixed bottom-6 right-6 btn btn-primary btn-circle shadow-lg z-40"
		>
			<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
			</svg>
		</button>
		
		<!-- Theme controller (hidden) -->
		<input type="hidden" id="theme-controller"/>
		
		<!-- HTMX config -->
		<script>
			// HTMX configuration
			htmx.config.globalViewTransitions = true;
			htmx.config.defaultSwapStyle = 'outerHTML';
			htmx.config.scrollBehavior = 'smooth';
			htmx.config.useTemplateFragments = true;
		</script>
	</body>
	</html>
}

templ EnhancedNavbar(currentPage string) {
	<nav class="navbar bg-base-100 shadow-lg sticky top-0 z-50 border-b border-base-300">
		<div class="container mx-auto">
			<!-- Mobile menu button -->
			<div class="navbar-start">
				<div class="dropdown lg:hidden">
					<div 
						tabindex="0" 
						role="button" 
						class="btn btn-ghost"
						x-on:click="sidebarOpen = !sidebarOpen"
					>
						<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
						</svg>
					</div>
				</div>
				
				<!-- Logo -->
				<a href="/" class="btn btn-ghost text-xl font-bold text-primary hover:scale-105 transition-transform">
					<div class="avatar">
						<div class="w-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center">
							<span class="text-white text-sm font-bold">W</span>
						</div>
					</div>
					Whalio
				</a>
			</div>
			
			<!-- Desktop menu -->
			<div class="navbar-center hidden lg:flex">
				<ul class="menu menu-horizontal px-1">
					<li><a href="/" class={ "btn btn-ghost", templ.KV("btn-active", currentPage == "Home") }>🏠 Home</a></li>
					<li><a href="/library" class="btn btn-ghost">📚 Library</a></li>
					<li><a href="/upload" class="btn btn-ghost">⬆️ Upload</a></li>
					<li><a href="/about" class={ "btn btn-ghost", templ.KV("btn-active", currentPage == "About") }>ℹ️ About</a></li>
				</ul>
			</div>
			
			<!-- Right side -->
			<div class="navbar-end gap-2">
				<!-- Search -->
				<div class="form-control">
					<div class="input-group">
						<input 
							type="text" 
							placeholder="Search..." 
							class="input input-bordered input-sm w-24 md:w-auto"
							hx-get="/api/search"
							hx-trigger="keyup changed delay:500ms"
							hx-target="#search-results"
						/>
						<button class="btn btn-square btn-sm">
							<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
							</svg>
						</button>
					</div>
				</div>
				
				<!-- Notifications -->
				<div class="dropdown dropdown-end">
					<div tabindex="0" role="button" class="btn btn-ghost btn-circle">
						<div class="indicator">
							<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5-5-5h5zm0 0V8a6 6 0 00-6-6H4a2 2 0 00-2 2v10a2 2 0 002 2h1"/>
							</svg>
							<span class="badge badge-xs badge-primary indicator-item">3</span>
						</div>
					</div>
					<div tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-80">
						<li class="menu-title">Notifications</li>
						<li><a>📢 New feature released!</a></li>
						<li><a>💬 You have 2 new messages</a></li>
						<li><a>🎉 Welcome to Whalio!</a></li>
					</div>
				</div>
				
				<!-- Theme selector -->
				<div class="dropdown dropdown-end">
					<div tabindex="0" role="button" class="btn btn-ghost btn-circle">
						<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
						</svg>
					</div>
					<ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-64 max-h-96 overflow-y-auto">
						<li class="menu-title">Choose Theme</li>
						<li><button onclick="setTheme('light')" class="justify-start">🌞 Light</button></li>
						<li><button onclick="setTheme('dark')" class="justify-start">🌙 Dark</button></li>
						<li><button onclick="setTheme('cupcake')" class="justify-start">🧁 Cupcake</button></li>
						<li><button onclick="setTheme('bumblebee')" class="justify-start">🐝 Bumblebee</button></li>
						<li><button onclick="setTheme('emerald')" class="justify-start">💚 Emerald</button></li>
						<li><button onclick="setTheme('corporate')" class="justify-start">🏢 Corporate</button></li>
						<li><button onclick="setTheme('synthwave')" class="justify-start">🌈 Synthwave</button></li>
						<li><button onclick="setTheme('cyberpunk')" class="justify-start">🤖 Cyberpunk</button></li>
						<li><button onclick="setTheme('valentine')" class="justify-start">💝 Valentine</button></li>
						<li><button onclick="setTheme('dracula')" class="justify-start">🧛 Dracula</button></li>
						<li><button onclick="setTheme('whalio')" class="justify-start">🐋 Whalio</button></li>
					</ul>
				</div>
			</div>
		</div>
		
		<!-- Mobile sidebar -->
		<div 
			x-show="sidebarOpen"
			x-transition:enter="transition ease-out duration-300"
			x-transition:enter-start="opacity-0"
			x-transition:enter-end="opacity-100"
			x-transition:leave="transition ease-in duration-200"
			x-transition:leave-start="opacity-100"
			x-transition:leave-end="opacity-0"
			@click.away="sidebarOpen = false"
			class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40"
		>
			<div 
				class="fixed left-0 top-0 w-80 h-full bg-base-100 shadow-xl z-50 transform transition-transform"
				x-show="sidebarOpen"
				x-transition:enter="transition ease-out duration-300"
				x-transition:enter-start="-translate-x-full"
				x-transition:enter-end="translate-x-0"
				x-transition:leave="transition ease-in duration-200"
				x-transition:leave-start="translate-x-0"
				x-transition:leave-end="-translate-x-full"
			>
				<div class="p-6">
					<div class="flex justify-between items-center mb-6">
						<h2 class="text-xl font-bold text-primary">Menu</h2>
						<button @click="sidebarOpen = false" class="btn btn-ghost btn-sm btn-circle">
							<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
							</svg>
						</button>
					</div>
					
					<ul class="menu w-full space-y-2">
						<li><a href="/" class="justify-start">🏠 Home</a></li>
						<li><a href="/library" class="justify-start">📚 Library</a></li>
						<li><a href="/upload" class="justify-start">⬆️ Upload</a></li>
						<li><a href="/about" class="justify-start">ℹ️ About</a></li>
					</ul>
				</div>
			</div>
		</div>
	</nav>
	
	<script>
		function setTheme(theme) {
			document.documentElement.setAttribute('data-theme', theme);
			localStorage.setItem('theme', theme);
			document.getElementById('theme-controller').value = theme;
			
			// Show toast notification
			if (window.whalio && window.whalio.showToast) {
				window.whalio.showToast(`Theme changed to ${theme}! 🎨`, 'success');
			}
		}
	</script>
}

templ EnhancedFooter() {
	<footer class="bg-base-200 text-base-content border-t border-base-300">
		<div class="container mx-auto px-4 py-12">
			<div class="grid grid-cols-1 md:grid-cols-4 gap-8">
				<!-- Brand -->
				<div class="space-y-4">
					<div class="flex items-center space-x-2">
						<div class="avatar">
							<div class="w-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center">
								<span class="text-white text-sm font-bold">W</span>
							</div>
						</div>
						<span class="text-xl font-bold text-primary">Whalio</span>
					</div>
					<p class="text-sm text-base-content/70">Modern web applications made simple with the power of Go, templ, HTMX, and DaisyUI.</p>
					
					<!-- Social Links -->
					<div class="flex space-x-2">
						<a href="#" class="btn btn-ghost btn-sm btn-circle">
							<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
								<path d="M12 0C5.374 0 0 5.373 0 12 0 17.302 3.438 21.8 8.207 23.387c.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"/>
							</svg>
						</a>
						<a href="#" class="btn btn-ghost btn-sm btn-circle">
							<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
								<path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
							</svg>
						</a>
						<a href="#" class="btn btn-ghost btn-sm btn-circle">
							<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
								<path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
							</svg>
						</a>
					</div>
				</div>
				
				<!-- Quick Links -->
				<div class="space-y-4">
					<h3 class="font-semibold text-lg">Quick Links</h3>
					<ul class="space-y-2 text-sm">
						<li><a href="/" class="link link-hover">🏠 Home</a></li>
						<li><a href="/about" class="link link-hover">ℹ️ About</a></li>
						<li><a href="/components" class="link link-hover">🧩 Components</a></li>
						<li><a href="/dashboard" class="link link-hover">📊 Dashboard</a></li>
					</ul>
				</div>
				
				<!-- Resources -->
				<div class="space-y-4">
					<h3 class="font-semibold text-lg">Resources</h3>
					<ul class="space-y-2 text-sm">
						<li><a href="#" class="link link-hover">📚 Documentation</a></li>
						<li><a href="#" class="link link-hover">🎓 Tutorials</a></li>
						<li><a href="#" class="link link-hover">💡 Examples</a></li>
						<li><a href="#" class="link link-hover">❓ FAQ</a></li>
					</ul>
				</div>
				
				<!-- Newsletter -->
				<div class="space-y-4">
					<h3 class="font-semibold text-lg">Stay Updated</h3>
					<p class="text-sm text-base-content/70">Get the latest updates and news.</p>
					<form class="space-y-2" hx-post="/api/newsletter" hx-target="#newsletter-result">
						<input 
							type="email" 
							placeholder="Enter your email" 
							class="input input-bordered input-sm w-full"
							required
						/>
						<button type="submit" class="btn btn-primary btn-sm w-full">
							📧 Subscribe
						</button>
					</form>
					<div id="newsletter-result"></div>
				</div>
			</div>
		</div>
		
		<!-- Copyright -->
		<div class="border-t border-base-300 py-6">
			<div class="container mx-auto px-4">
				<div class="flex flex-col md:flex-row justify-between items-center space-y-2 md:space-y-0">
					<p class="text-sm text-base-content/70">
						© 2024 Whalio. Built with ❤️ using Go, templ, HTMX & DaisyUI.
					</p>
					<div class="flex items-center space-x-4 text-sm">
						<a href="/privacy" class="link link-hover">Privacy</a>
						<a href="/terms" class="link link-hover">Terms</a>
						<a href="/contact" class="link link-hover">Contact</a>
					</div>
				</div>
			</div>
		</div>
	</footer>
}

templ PlayerBar() {
	<!-- Persistent Audio Player Bar -->
	<div id="player-bar" class="fixed bottom-0 left-0 right-0 z-50 bg-base-200 border-t border-base-300 shadow-lg hidden">
		<div class="container mx-auto px-4 py-3">
			<div class="flex items-center gap-4">
				<!-- Cover / Placeholder -->
				<div class="avatar">
					<div class="w-12 rounded-lg bg-gradient-to-br from-primary/30 to-secondary/30 flex items-center justify-center">
						<span class="text-xl">🎵</span>
					</div>
				</div>

				<!-- Track info -->
				<div class="min-w-0 flex-1">
					<div class="flex items-center justify-between">
						<div class="min-w-0">
							<div id="player-title" class="font-semibold truncate">—</div>
							<div id="player-artist" class="text-sm text-base-content/60 truncate">—</div>
						</div>
						<div class="flex items-center gap-2">
							<span id="player-current" class="text-xs text-base-content/60 w-10 text-right">0:00</span>
							<input id="player-seek" type="range" min="0" max="100" value="0" class="range range-xs range-primary w-56"/>
							<span id="player-duration" class="text-xs text-base-content/60 w-10">0:00</span>
						</div>
					</div>
				</div>

				<!-- Controls -->
				<div class="flex items-center gap-2">
					<button id="player-prev" class="btn btn-circle btn-ghost btn-sm" title="Previous">
						<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7v14zm9-14l-7 7 7 7V5z"/></svg>
					</button>
					<button id="player-play" class="btn btn-circle btn-primary" title="Play/Pause">
						<svg id="player-play-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 4l15 8-15 8z"/></svg>
					</button>
					<button id="player-next" class="btn btn-circle btn-ghost btn-sm" title="Next">
						<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7V5zM4 5l7 7-7 7V5z"/></svg>
					</button>
					<div class="flex items-center gap-2 ml-2">
						<svg class="w-4 h-4 text-base-content/70" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5l-6 4v6l6 4V5zM15 9a3 3 0 010 6m2-8a5 5 0 010 10"/></svg>
						<input id="player-volume" type="range" min="0" max="100" value="80" class="range range-xs w-28"/>
					</div>
				</div>

				<!-- Hidden audio element -->
				<audio id="whalio-audio" preload="none"></audio>
			</div>
		</div>
	</div>
}

templ GlobalModals() {
	<!-- Search Results Modal -->
	<dialog id="search-modal" class="modal">
		<div class="modal-box w-11/12 max-w-2xl">
			<h3 class="font-bold text-lg mb-4">🔍 Search Results</h3>
			<div id="search-results" class="space-y-4">
				<div class="flex items-center justify-center py-8">
					<div class="text-center">
						<div class="text-4xl mb-2">🔍</div>
						<p class="text-base-content/70">Start typing to search...</p>
					</div>
				</div>
			</div>
			<div class="modal-action">
				<form method="dialog">
					<button class="btn">Close</button>
				</form>
			</div>
		</div>
		<form method="dialog" class="modal-backdrop">
			<button>close</button>
		</form>
	</dialog>
	
	<!-- Confirmation Modal -->
	<dialog id="confirm-modal" class="modal">
		<div class="modal-box">
			<h3 class="font-bold text-lg">Confirm Action</h3>
			<p class="py-4" id="confirm-message">Are you sure you want to proceed?</p>
			<div class="modal-action">
				<button id="confirm-cancel" class="btn">Cancel</button>
				<button id="confirm-ok" class="btn btn-error">Confirm</button>
			</div>
		</div>
	</dialog>
}